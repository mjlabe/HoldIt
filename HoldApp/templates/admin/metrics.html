{% extends 'base/base.html' %}

{% load staticfiles %}

{% load widget_tweaks %}

{% block content %}

    <!-- saved from url=(0062)https://www.w3schools.com/w3css/tryw3css_templates_website.htm -->
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css">.gm-style .gm-style-mtc label,.gm-style .gm-style-mtc div{font-weight:400}
</style><link type="text/css" rel="stylesheet" href={%  static 'W3.CSS Template_files/css' %}><style type="text/css">.gm-style .gm-style-cc span,.gm-style .gm-style-cc a,.gm-style .gm-style-mtc div{font-size:10px}
</style><style type="text/css">@media print {  .gm-style .gmnoprint, .gmnoprint {    display:none  }}@media screen {  .gm-style .gmnoscreen, .gmnoscreen {    display:none  }}</style><style type="text/css">.gm-style-pbc{transition:opacity ease-in-out;background-color:rgba(0,0,0,0.45);text-align:center}.gm-style-pbt{font-size:22px;color:white;font-family:Roboto,Arial,sans-serif;position:relative;margin:0;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%)}
</style>

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href={%  static 'W3.CSS Template_files/w3.css' %}>
<link rel="stylesheet" href={%  static 'W3.CSS Template_files/w3-theme-black.css' %}>
<link rel="stylesheet" href={%  static 'W3.CSS Template_files/font-awesome.min.css' %}>
<script type="text/javascript" charset="UTF-8" src={%  static 'W3.CSS Template_files/common.js.download' %}></script><script type="text/javascript" charset="UTF-8" src={%  static 'W3.CSS Template_files/util.js.download' %}></script><script type="text/javascript" charset="UTF-8" src={%  static 'W3.CSS Template_files/map.js.download' %}></script><script type="text/javascript" charset="UTF-8" src={%  static 'W3.CSS Template_files/marker.js.download' %}></script><style type="text/css">.gm-style {
        font: 400 11px Roboto, Arial, sans-serif;
        text-decoration: none;
      }
      .gm-style img { max-width: none; }</style><script type="text/javascript" charset="UTF-8" src={%  static 'W3.CSS Template_files/onion.js.download' %}> </script><script type="text/javascript" charset="UTF-8" src={%  static 'W3.CSS Template_files/controls.js.download' %}> </script><script type="text/javascript" charset="UTF-8" src={%  static 'W3.CSS Template_files/stats.js.download' %}></script></head>

<h1 style="padding-top: 50px">Metrics</h1>

<script type="text/javascript">
    var datefield=document.createElement("input");
    datefield.setAttribute("type", "date");
    if (datefield.type!="date"){ //if browser doesn't support input type="date", load files for jQuery UI Date Picker
        document.write('<link href={% static 'googleAPI/jquery-ui.css' %} rel="stylesheet" type="text/css" />\n');
        document.write('<script src={% static 'googleAPI/jquery.min.js' %}><\/script>\n');
        document.write('<script src={% static 'googleAPI/jquery-ui.min.js' %}><\/script>\n');
    }
</script>

<script>
if (datefield.type!="date"){ //if browser doesn't support input type="date", initialize date picker widget:
    jQuery(function($){ //on document.ready
        $('#birthday').datepicker();
    })
}
</script>

<form method="post">
  {% csrf_token %}

    Start:<input type="date" id="start" name="start" size="20" value="{{ start }}" />
    End:<input type="date" id="end" name="end" size="20" value="{{ end }}" />
    <button type="submit" class="w3-button w3-theme">Submit</button>
    <div><p class="w3-red"> {{ error.end }} </p></div>
</form>

<!-- Load c3.css -->
<link href={%  static 'c3-0.6.2/c3.css' %} rel="stylesheet">

    <div id="chart"></div>

<!-- Load d3.js and c3.js -->
<script src={%  static 'd3/d3.min.js' %} charset="utf-8"></script>
<script src={%  static 'c3-0.6.2/c3.js' %}></script>
<script type="text/javascript">

data_metrics = {{ data|safe }};
chart_group = [];
var chart = c3.generate({
    data: {
        x: 'Date',
        columns: data_metrics ,
        type: 'bar',
        order: 'null',
         onclick: function() { alternate(); }
    },
    grid: {
        y: {
            lines: [{value:0}]
        }
    },
    axis: {
        x: {
            type: 'timeseries',
            tick: {
                format: '%b-%Y'
            }
        }
    }
});

setTimeout(function () {
    for (var i = 1; i < data_metrics.length; i++){
        chart_group.push(data_metrics[i][0]);
    }

    console.log(chart_group);
    chart.groups([chart_group])
}, 1000);

var mode = 0;

function alternate(){

    if (mode == 0)
    {
        chart.groups([[]]);
        mode = 1;
    }

    else
    {
        chart.groups([chart_group]);
        mode = 0;
    }

}

</script>


{#{{ chart.as_html }}#}

{% endblock %}